<?xml version="1.0" encoding="UTF-8"?>
<project name="TP_note_medev_lacoustille_poulet" default="build" basedir=".">
    <description>TP note MEDEV Lacoustille-Poulet.</description>
    <path id="junit.platform.libs.classpath">
        <fileset dir="lib/junit-platform/"/>
    </path>
    <path id="junit.engine.jupiter.classpath">
        <fileset dir="lib/jupiter/"/>
    </path>

    <target name="checkDependencies" description="Check if dependencies are satisfied">
        <property name="src.location" location="src"/>
        <property name="classes.location" location="build/classes"/>
        <property name="tests.location" location="src"/>
        <echo message="Source directory is ${src.location}"/>
        <echo message="Classes directory is ${classes.location}"/>
        <condition property="src.available">
            <and>
                <available file="${src.location}" type="dir"/>
                <available file="${classes.location}" type="dir"/>
            </and>
        </condition>
    </target>

    <target name="build" description="Build the application" depends="checkDependencies" if="src.available">
        <echo message="Building Application..."/>
        <javac srcdir="src" destdir="${classes.location}" includeAntRuntime="false">
            <classpath refid="junit.engine.jupiter.classpath"/>
        </javac>
        <echo message="Done!"/>
        <echo message="Generating Executable..."/>
        <jar basedir="${classes.location}" destfile="build/executable/TP_note_medev_lacoustille_poulet.jar">
            <manifest>
                <attribute name="Main-Class" value="org.centrale.medev.tpnote.Test"/>
            </manifest>
        </jar>
        <echo message="Done!"/>
        <echo message="Generating Javadoc..."/>
        <javadoc packagenames="org.centrale.medev.tpnote.*" sourcepath="src/main" destdir="build/documentation" author="true" version="true" use="true" >
            <doctitle><![CDATA[<h1> TP not√© MEDEV Lacoustille Poulet </h1>]]></doctitle>
            <bottom><![CDATA[<i>CNTCNC Productions. All Right Reserved. </i>]]></bottom>
            <link offline="true" href="https://docs.oracle.com/javase/8/docs/api/" packagelistLoc="C:\tmp"/>
            <link href="https://docs.oracle.com/javase/8/docs/api/"/>
        </javadoc>
        <echo message="Done!"/>
        <echo message="Generating tests..."/>
        <junitlauncher>
            <classpath refid="junit.platform.libs.classpath"/>
            <classpath refid="junit.engine.jupiter.classpath"/>
            <classpath>
                <pathelement location="${classes.location}"/>
            </classpath>
            <echo message="imported junits"/>
            <testclasses outputdir="build/testReports">
                <fileset dir="${classes.location}"/>
                <echo message="Imported generated classes"/>
                <listener type="legacy-brief" sendSysOut="true"/>
                <listener type="legacy-xml" sendSysErr="true" sendSysOut="true"/>
            </testclasses>
        </junitlauncher>
        <echo message="Done!"/>
    </target>
</project>

    